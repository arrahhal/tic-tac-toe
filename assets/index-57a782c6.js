(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function n(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(t){if(t.ep)return;t.ep=!0;const a=n(t);fetch(t.href,a)}})();class m{constructor(e=""){this.value=e}setValue(e){this.value=e}getValue(){return this.value}}class g{constructor(e="",n="",l=!1){this.name=e,this.sign=n,this.isHisTurn=l}getName(){return this.name}getSign(){return this.sign}getHisTurn(){return this.isHisTurn}toggleHisTurn(){this.isHisTurn=!this.isHisTurn}}class f{constructor(){this.cells=[],this.winner=null,this.players=[new g("Player x","X",!0),new g("Player o","O",!1)],this.isAiModeActive=!1,this.initialize()}initialize(){this.cells=Array.from({length:9},()=>new m),this.winner=null}getCellsValues(){return this.cells.map(e=>e.getValue())}activateAiMode(){this.isAiModeActive=!0}deActivateAiMode(){this.isAiModeActive=!1}getRandomIndex(){return Math.floor(Math.random()*9)}getAiChoice(){let e=this.getRandomIndex();for(;this.cells[e].getValue()!=="";)e=this.getRandomIndex();return e}playRound(e){const n=this.getCurrentPlayer(),l=this.cells[e];l.getValue()===""&&(l.setValue(n.getSign()),this.checkWin()?this.setWinner(n):this.checkTie()?this.setWinner(null):this.switchPlayersTurns())}getCurrentPlayer(){return this.players.find(e=>e.getHisTurn()===!0)}switchPlayersTurns(){this.players.forEach(e=>e.toggleHisTurn())}setWinner(e){this.winner=e}getWinner(){return this.winner}checkWin(){const e=this.getCellsValues();return[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]].some(l=>l.every(t=>e[t]===this.getCurrentPlayer().getSign()))}checkTie(){return this.getCellsValues().every(n=>n!=="")}isGameOver(){return!!(this.checkTie()||this.checkWin())}}const i={playRound:s=>c.playRound(s),getWinner:()=>c.getWinner(),initializeNewGame:()=>c.initialize(),getCellsValues:()=>c.getCellsValues(),activateAiMode:()=>c.activateAiMode(),deActivateAiMode:()=>c.deActivateAiMode(),getAiChoice:()=>c.getAiChoice(),isAiModeActive:()=>c.isAiModeActive,checkWin:()=>c.checkWin(),checkTie:()=>c.checkTie(),isGameOver:()=>c.isGameOver()},c=new f,o={vsPlayerBtn:document.getElementById("start-page__vsplayer-btn"),vsAiBtn:document.getElementById("start-page__vsai-btn"),returnBtn:document.getElementById("game-page__return-btn"),board:document.getElementById("game-board"),cellElements:document.querySelectorAll(".cell"),resultPane:document.getElementById("result"),xTurnElement:document.getElementById("x-player"),oTurnElement:document.getElementById("o-player"),startPage:document.getElementById("start-page"),gamePage:document.getElementById("game-page")};function y(s){o.resultPane.classList.add("show-result"),o.resultPane.textContent=s,setTimeout(()=>{o.resultPane.classList.remove("show-result")},2e3)}function v(s){let e=0;s.forEach(n=>{const l=document.querySelector(`[data-index="${e}"]`);l.textContent=n,l.className=`cell text-${n.toLowerCase()}`,e++})}function p(){o.cellElements.forEach(s=>{s.textContent="",s.classList.remove("text-o","text-x")})}function A(s){return s.textContent===""}function C(){o.startPage.classList.toggle("is-hidden"),o.gamePage.classList.toggle("is-hidden")}const r={selectors:o,displayResultMessage:y,clearBoard:p,checkEmpty:A,toggleGamePage:C,setBoard:v};function P(){document.addEventListener("DOMContentLoaded",()=>i.initializeNewGame());function s(){i.checkWin()?r.displayResultMessage(`${i.getWinner().getName()} is the winner`):i.checkTie()&&r.displayResultMessage("It's a tie")}function e(){s(),i.initializeNewGame(),r.clearBoard()}let n=!1;function l(d){if(!n&&r.checkEmpty(d.target)){const h=d.target.dataset.index;if(i.playRound(h),r.setBoard(i.getCellsValues()),i.isGameOver()){e();return}i.isAiModeActive()&&(n=!0,setTimeout(()=>{if(i.playRound(i.getAiChoice()),r.setBoard(i.getCellsValues()),i.isGameOver()){e();return}n=!1},1e3))}}function t(){i.initializeNewGame(),i.deActivateAiMode(),r.clearBoard(),r.toggleGamePage()}function a(){r.toggleGamePage()}function u(){i.initializeNewGame(),i.activateAiMode(),r.clearBoard(),r.toggleGamePage()}r.selectors.vsAiBtn.addEventListener("click",u),r.selectors.returnBtn.addEventListener("click",a),r.selectors.board.addEventListener("click",l),r.selectors.vsPlayerBtn.addEventListener("click",t)}P();
