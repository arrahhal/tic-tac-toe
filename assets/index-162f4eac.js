(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(t){if(t.ep)return;t.ep=!0;const i=s(t);fetch(t.href,i)}})();class d{constructor(e="",s="",n=!1){this.name=e,this.sign=s,this.isHisTurn=n}getName(){return this.name}getSign(){return this.sign}getHisTurn(){return this.isHisTurn}toggleHisTurn(){this.isHisTurn=!this.isHisTurn}}class m{constructor(){this.cells=[],this.winner=null,this.players=[new d("Player x","X",!0),new d("Player o","O",!1)],this.isAiModeActive=!1,this.initialize()}initialize(){this.cells=Array.from({length:9},()=>""),this.winner=null}getCellsValues(e=this.cells){return e}activateAiMode(){this.isAiModeActive=!0}deActivateAiMode(){this.isAiModeActive=!1}evaluateScore(e){if(this.checkWin(e,this.players[0]))return-1;if(this.checkWin(e,this.players[1]))return 1;if(this.checkTie(e))return 0}minimax(e,s,n){if(this.isGameOver(e))return this.evaluateScore(e);if(n){let t=-9999;for(let i=0;i<e.length;i++)if(e[i]===""){e[i]=this.players[1].sign;let o=this.minimax(e,s+1,!1);e[i]="",t=Math.max(o,t)}return t}else{let t=9999;for(let i=0;i<e.length;i++)if(e[i]===""){e[i]=this.players[0].sign;let o=this.minimax(e,s+1,!0);e[i]="",t=Math.min(o,t)}return t}}getAiChoice(){let e=-1/0,s;for(let n=0;n<this.cells.length;n++)if(this.cells[n]===""){this.cells[n]=this.players[1].sign;let t=this.minimax(this.cells,0,!1);this.cells[n]="",t>e&&(e=t,s=n)}return s}playRound(e){const s=this.getCurrentPlayer();this.cells[e]===""&&(this.cells[e]=s.getSign(),this.checkWin()?this.setWinner(s):this.checkTie()?this.setWinner(null):this.switchPlayersTurns())}getCurrentPlayer(){return this.players.find(e=>e.getHisTurn()===!0)}switchPlayersTurns(){this.players.forEach(e=>e.toggleHisTurn())}setWinner(e){this.winner=e}getWinner(){return this.winner}checkWin(e=this.cells,s=this.getCurrentPlayer()){return[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]].some(t=>t.every(i=>e[i]===s.sign))}checkTie(e=this.cells){return e.every(s=>s!=="")}isGameOver(e=this.cells){return this.checkTie(e)||this.checkWin(e,this.players[0])||this.checkWin(e,this.players[1])}}const r={playRound:l=>c.playRound(l),getWinner:()=>c.getWinner(),initializeNewGame:()=>c.initialize(),getCellsValues:()=>c.getCellsValues(),activateAiMode:()=>c.activateAiMode(),deActivateAiMode:()=>c.deActivateAiMode(),getAiChoice:()=>c.getAiChoice(),isAiModeActive:()=>c.isAiModeActive,checkWin:()=>c.checkWin(),checkTie:()=>c.checkTie(),isGameOver:()=>c.isGameOver()},c=new m,u={vsPlayerBtn:document.getElementById("start-page__vsplayer-btn"),vsAiBtn:document.getElementById("start-page__vsai-btn"),returnBtn:document.getElementById("game-page__return-btn"),board:document.getElementById("game-board"),cellElements:document.querySelectorAll(".cell"),resultPane:document.getElementById("result"),xTurnElement:document.getElementById("x-player"),oTurnElement:document.getElementById("o-player"),startPage:document.getElementById("start-page"),gamePage:document.getElementById("game-page")};function f(l){u.resultPane.classList.add("show-result"),u.resultPane.textContent=l,setTimeout(()=>{u.resultPane.classList.remove("show-result")},2e3)}function y(l){let e=0;l.forEach(s=>{const n=document.querySelector(`[data-index="${e}"]`);n.textContent=s,n.className=`cell text-${s.toLowerCase()}`,e++})}function p(){u.cellElements.forEach(l=>{l.textContent="",l.classList.remove("text-o","text-x")})}function v(l){return l.textContent===""}function A(){u.startPage.classList.toggle("is-hidden"),u.gamePage.classList.toggle("is-hidden")}const a={selectors:u,displayResultMessage:f,clearBoard:p,checkEmpty:v,toggleGamePage:A,setBoard:y};function P(){document.addEventListener("DOMContentLoaded",()=>r.initializeNewGame());function l(){r.checkWin()?a.displayResultMessage(`${r.getWinner().getName()} is the winner`):r.checkTie()&&a.displayResultMessage("It's a tie")}function e(){l(),r.initializeNewGame(),a.clearBoard()}let s=!1;function n(h){if(!s&&a.checkEmpty(h.target)){const g=h.target.dataset.index;if(r.playRound(g),a.setBoard(r.getCellsValues()),r.isGameOver()){e();return}r.isAiModeActive()&&(s=!0,setTimeout(()=>{if(r.playRound(r.getAiChoice()),a.setBoard(r.getCellsValues()),r.isGameOver()){e();return}s=!1},1e3))}}function t(){r.initializeNewGame(),r.deActivateAiMode(),a.clearBoard(),a.toggleGamePage()}function i(){a.toggleGamePage()}function o(){r.initializeNewGame(),r.activateAiMode(),a.clearBoard(),a.toggleGamePage()}a.selectors.vsAiBtn.addEventListener("click",o),a.selectors.returnBtn.addEventListener("click",i),a.selectors.board.addEventListener("click",n),a.selectors.vsPlayerBtn.addEventListener("click",t)}P();
